(function () {
    "use strict";

    function GET_DECKS() {
        return [
            {
                name:  "Abzan Midrange",
                cards: {
                    "Siege Rhino":              {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    },
                    "Wingmate Roc":             {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    },
                    "Thoughtseize":             {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    },
                    "Sylvan Caryatid":          {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    },
                    "Sorin, Solemn Visitor":    {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    },
                    "Hero's Downfall":          {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    },
                    "End Hostilities":          {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    },
                    "Elspeth, Sun's Champion":  {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    },
                    "Courser of Kruphix":       {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    },
                    "Ajani, Mentor of Heroes":  {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    },
                    "Abzan Charm":              {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    },
                    "Windswept Heath":          {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    },
                    "Urborg, Tomb of Yawgmoth": {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Silence":        {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    },
                    "Temple of Plenty":         {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Malady":         {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    },
                    "Sandsteppe Citadel":       {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    },
                    "Plains":                   {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    },
                    "Mana Confluence":          {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    },
                    "Llanowar Wastes":          {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    },
                    "Forest":                   {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    },
                    "Caves of Koilos":          {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                }
            },
            {
                name:    "Jeskai Wins",
                //current: true,
                cards:   {
                    "Siege Rhino":              {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    },
                    "Wingmate Roc":             {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    },
                    "Thoughtseize":             {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    },
                    "Sylvan Caryatid":          {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    },
                    "Sorin, Solemn Visitor":    {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    },
                    "Hero's Downfall":          {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    },
                    "End Hostilities":          {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    },
                    "Elspeth, Sun's Champion":  {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    },
                    "Courser of Kruphix":       {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    },
                    "Ajani, Mentor of Heroes":  {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    },
                    "Abzan Charm":              {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    },
                    "Windswept Heath":          {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    },
                    "Urborg, Tomb of Yawgmoth": {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Silence":        {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    },
                    "Temple of Plenty":         {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Malady":         {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    },
                    "Sandsteppe Citadel":       {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    },
                    "Plains":                   {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    },
                    "Mana Confluence":          {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    },
                    "Llanowar Wastes":          {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    },
                    "Forest":                   {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    },
                    "Caves of Koilos":          {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                }
            },
            {
                name:  "UB Control",
                cards: {
                    "Siege Rhino":              {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    },
                    "Wingmate Roc":             {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    },
                    "Thoughtseize":             {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    },
                    "Sylvan Caryatid":          {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    },
                    "Sorin, Solemn Visitor":    {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    },
                    "Hero's Downfall":          {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    },
                    "End Hostilities":          {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    },
                    "Elspeth, Sun's Champion":  {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    },
                    "Courser of Kruphix":       {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    },
                    "Ajani, Mentor of Heroes":  {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    },
                    "Abzan Charm":              {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    },
                    "Windswept Heath":          {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    },
                    "Urborg, Tomb of Yawgmoth": {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Silence":        {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    },
                    "Temple of Plenty":         {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Malady":         {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    },
                    "Sandsteppe Citadel":       {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    },
                    "Plains":                   {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    },
                    "Mana Confluence":          {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    },
                    "Llanowar Wastes":          {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    },
                    "Forest":                   {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    },
                    "Caves of Koilos":          {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                }
            },
            {
                name:  "Golgari Constellation",
                cards: {
                    "Siege Rhino":              {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    },
                    "Wingmate Roc":             {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    },
                    "Thoughtseize":             {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    },
                    "Sylvan Caryatid":          {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    },
                    "Sorin, Solemn Visitor":    {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    },
                    "Hero's Downfall":          {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    },
                    "End Hostilities":          {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    },
                    "Elspeth, Sun's Champion":  {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    },
                    "Courser of Kruphix":       {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    },
                    "Ajani, Mentor of Heroes":  {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    },
                    "Abzan Charm":              {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    },
                    "Windswept Heath":          {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    },
                    "Urborg, Tomb of Yawgmoth": {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Silence":        {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    },
                    "Temple of Plenty":         {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Malady":         {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    },
                    "Sandsteppe Citadel":       {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    },
                    "Plains":                   {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    },
                    "Mana Confluence":          {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    },
                    "Llanowar Wastes":          {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    },
                    "Forest":                   {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    },
                    "Caves of Koilos":          {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                }
            },
            {
                name:  "Temur Aggro",
                cards: {
                    "Siege Rhino":              {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    },
                    "Wingmate Roc":             {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    },
                    "Thoughtseize":             {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    },
                    "Sylvan Caryatid":          {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    },
                    "Sorin, Solemn Visitor":    {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    },
                    "Hero's Downfall":          {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    },
                    "End Hostilities":          {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    },
                    "Elspeth, Sun's Champion":  {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    },
                    "Courser of Kruphix":       {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    },
                    "Ajani, Mentor of Heroes":  {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    },
                    "Abzan Charm":              {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    },
                    "Windswept Heath":          {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    },
                    "Urborg, Tomb of Yawgmoth": {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Silence":        {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    },
                    "Temple of Plenty":         {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    },
                    "Temple of Malady":         {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    },
                    "Sandsteppe Citadel":       {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    },
                    "Plains":                   {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    },
                    "Mana Confluence":          {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    },
                    "Llanowar Wastes":          {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    },
                    "Forest":                   {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    },
                    "Caves of Koilos":          {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                }
            }
        ];
    }

    angular.module('app.utilities.topdeckOdds.utils', [])
        .factory('topdeckOddsUtils', function () {
            var allDecks,
                PLACEHOLDER;

            (function INIT() {
                // Retrieve all decks if this is the first call of the service
                if (allDecks === undefined) {
                    allDecks = GET_DECKS();
                }
            }());

            /**
             * Publicly Exposed Functionality
             */

            this.getDecks = function () {
                return allDecks;
            };

            this.getCurrentDeck = function () {
                var currentDeck = null;

                allDecks.forEach(function (deck /*, index */) {
                    if (deck.current === true) {
                        currentDeck = angular.copy(deck);
                    }
                });

                return currentDeck;
            };

            this.setCurrentDeck = function (argDeck) {
                var selectedIndex, newDeck;

                selectedIndex = -1;
                allDecks.forEach(function (deck, index) {
                    deck.current = false;

                    // If any card lists are the same, store the index
                    if (angular.equals(deck.cards, argDeck.cards)) {
                        console.dir(deck.cards);
                        console.dir(argDeck.cards);
                        selectedIndex = index;
                    }
                });

                if (selectedIndex === -1) {
                    newDeck = angular.copy(argDeck);
                    newDeck.current = true;
                    newDeck.custom = true;

                    allDecks.push(newDeck);
                } else {
                    allDecks[selectedIndex].current = true;
                }
            };

            return this;
        });
}());

