(function () {
    "use strict";

    function GET_DECKS_FROM_BACKEND() {
        return [
            {
                name:  "Abzan Midrange",
                cards: [
                    {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                ]
            },
            {
                name:  "Jeskai Wins",
                //current: true,
                cards: [
                    {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                ]
            },
            {
                name:  "UB Control",
                cards: [
                    {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                ]
            },
            {
                name:  "Golgari Constellation",
                cards: [
                    {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                ]
            },
            {
                name:  "Temur Aggro",
                cards: [
                    {
                        name:  "Siege Rhino",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Wingmate Roc",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Thoughtseize",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sylvan Caryatid",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sorin, Solemn Visitor",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Hero's Downfall",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "End Hostilities",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Elspeth, Sun's Champion",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Courser of Kruphix",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Ajani, Mentor of Heroes",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Abzan Charm",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Windswept Heath",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Urborg, Tomb of Yawgmoth",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Silence",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Temple of Plenty",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Temple of Malady",
                        count: 4,
                        tags:  []
                    }, {
                        name:  "Sandsteppe Citadel",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Plains",
                        count: 2,
                        tags:  []
                    }, {
                        name:  "Mana Confluence",
                        count: 1,
                        tags:  []
                    }, {
                        name:  "Llanowar Wastes",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Forest",
                        count: 3,
                        tags:  []
                    }, {
                        name:  "Caves of Koilos",
                        count: 4,
                        tags:  []
                    }
                ]
            }
        ];
    }

    angular.module('app.utilities.topdeckOdds.utils', [
        'models.topdeckOdds.card',
        'models.topdeckOdds.deck'
    ]).service('topdeckOddsUtils', function (Card, Deck) {
        var allDecks,
            currentDeck,
            PLACEHOLDER;

        function buildDeckHash(argDecksList) {
            var deckHash,
                cardList;

            deckHash = {};
            argDecksList.forEach(function (deck) {
                cardList = [];
                deck.cards.forEach(function (card) {
                    cardList.push(new Card(card.name, card.count, card.tags));
                });

                deckHash[deck.name] = new Deck(deck.name, cardList);
            });

            return deckHash;
        }

        (function INIT() {
            // Retrieve all decks if this is the first call of the service
            if (allDecks === undefined) {
                allDecks = buildDeckHash(GET_DECKS_FROM_BACKEND());
                currentDeck = allDecks["Abzan Midrange"]; // TODO - Remove this and store deck in local storage.
            }
        }());

        /**
         * Publicly Exposed Functionality
         */

        this.getDecks = function () {
            return allDecks;
        };

        this.getCurrentDeck = function () {
            return currentDeck;
        };

        this.setCurrentDeck = function (argDeck) {
            currentDeck = argDeck;
        };
    });
}());

